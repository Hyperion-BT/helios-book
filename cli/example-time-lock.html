<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Example: Time lock - The Helios Smart Contract Language</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/custom.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item affix "><a href="../understanding-eutxos.html">Understanding eUTxOs</a></li><li class="chapter-item affix "><a href="../changelog.html">Changelog</a></li><li class="chapter-item "><a href="../lang/index.html"><strong aria-hidden="true">1.</strong> Helios language</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lang/comments.html"><strong aria-hidden="true">1.1.</strong> Comments</a></li><li class="chapter-item "><a href="../lang/variables.html"><strong aria-hidden="true">1.2.</strong> Variables</a></li><li class="chapter-item "><a href="../lang/primitive-types.html"><strong aria-hidden="true">1.3.</strong> Primitive types</a></li><li class="chapter-item "><a href="../lang/container-types.html"><strong aria-hidden="true">1.4.</strong> Container types</a></li><li class="chapter-item "><a href="../lang/branching.html"><strong aria-hidden="true">1.5.</strong> Branching</a></li><li class="chapter-item "><a href="../lang/print_error_assert.html"><strong aria-hidden="true">1.6.</strong> Print, error, assert</a></li><li class="chapter-item "><a href="../lang/functions/index.html"><strong aria-hidden="true">1.7.</strong> Functions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lang/functions/multiple_return_values.html"> Multiple return values</a></li><li class="chapter-item "><a href="../lang/functions/void.html"> Void functions</a></li><li class="chapter-item "><a href="../lang/functions/anonymous.html"> Anonymous functions</a></li><li class="chapter-item "><a href="../lang/functions/unused_arguments.html"> Unused arguments</a></li><li class="chapter-item "><a href="../lang/functions/optional_arguments.html"> Optional arguments</a></li><li class="chapter-item "><a href="../lang/functions/named_arguments.html"> Named arguments</a></li><li class="chapter-item "><a href="../lang/functions/values.html"> Function values</a></li><li class="chapter-item "><a href="../lang/functions/example.html"> Example: Collatz sequence</a></li></ol></li><li class="chapter-item "><a href="../lang/operators.html"><strong aria-hidden="true">1.8.</strong> Operators</a></li><li class="chapter-item "><a href="../lang/structs.html"><strong aria-hidden="true">1.9.</strong> Structs</a></li><li class="chapter-item "><a href="../lang/enums.html"><strong aria-hidden="true">1.10.</strong> Enums</a></li><li class="chapter-item "><a href="../lang/destructuring.html"><strong aria-hidden="true">1.11.</strong> Destructuring</a></li><li class="chapter-item "><a href="../lang/methods.html"><strong aria-hidden="true">1.12.</strong> Methods</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lang/associated-functions-and-constants.html"> Associated functions and constants</a></li><li class="chapter-item "><a href="../lang/automatic-methods.html"> Automatic methods</a></li><li class="chapter-item "><a href="../lang/example-rational.html"> Example: Rational</a></li></ol></li><li class="chapter-item "><a href="../lang/generics.html"><strong aria-hidden="true">1.13.</strong> Generics</a></li><li class="chapter-item "><a href="../lang/script-structure.html"><strong aria-hidden="true">1.14.</strong> Structure of a script</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lang/example-script.html"> Example: always_succeeds</a></li><li class="chapter-item "><a href="../lang/parameterized.html"> Contract Parameters</a></li></ol></li><li class="chapter-item "><a href="../lang/modules.html"><strong aria-hidden="true">1.15.</strong> Modules</a></li><li class="chapter-item "><a href="../lang/builtins/index.html"><strong aria-hidden="true">1.16.</strong> Builtins</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lang/builtins/address.html"> Address</a></li><li class="chapter-item "><a href="../lang/builtins/any.html"> Any</a></li><li class="chapter-item "><a href="../lang/builtins/assetclass.html"> AssetClass</a></li><li class="chapter-item "><a href="../lang/builtins/bool.html"> Bool</a></li><li class="chapter-item "><a href="../lang/builtins/bytearray.html"> ByteArray</a></li><li class="chapter-item "><a href="../lang/builtins/credential.html"> Credential</a></li><li class="chapter-item "><a href="../lang/builtins/data.html"> Data</a></li><li class="chapter-item "><a href="../lang/builtins/datumhash.html"> DatumHash</a></li><li class="chapter-item "><a href="../lang/builtins/dcert.html"> DCert</a></li><li class="chapter-item "><a href="../lang/builtins/duration.html"> Duration</a></li><li class="chapter-item "><a href="../lang/builtins/int.html"> Int</a></li><li class="chapter-item "><a href="../lang/builtins/list.html"> List</a></li><li class="chapter-item "><a href="../lang/builtins/map.html"> Map</a></li><li class="chapter-item "><a href="../lang/builtins/mintingpolicyhash.html"> MintingPolicyHash</a></li><li class="chapter-item "><a href="../lang/builtins/option.html"> Option</a></li><li class="chapter-item "><a href="../lang/builtins/outputdatum.html"> OutputDatum</a></li><li class="chapter-item "><a href="../lang/builtins/pubkey.html"> PubKey</a></li><li class="chapter-item "><a href="../lang/builtins/pubkeyhash.html"> PubKeyHash</a></li><li class="chapter-item "><a href="../lang/builtins/real.html"> Real</a></li><li class="chapter-item "><a href="../lang/builtins/scriptcontext.html"> ScriptContext</a></li><li class="chapter-item "><a href="../lang/builtins/scripthash.html"> ScriptHash</a></li><li class="chapter-item "><a href="../lang/builtins/scriptpurpose.html"> ScriptPurpose</a></li><li class="chapter-item "><a href="../lang/builtins/stakekeyhash.html"> StakeKeyHash</a></li><li class="chapter-item "><a href="../lang/builtins/stakingcredential.html"> StakingCredential</a></li><li class="chapter-item "><a href="../lang/builtins/stakinghash.html"> StakingHash</a></li><li class="chapter-item "><a href="../lang/builtins/stakingpurpose.html"> StakingPurpose</a></li><li class="chapter-item "><a href="../lang/builtins/stakingvalidatorhash.html"> StakingValidatorHash</a></li><li class="chapter-item "><a href="../lang/builtins/string.html"> String</a></li><li class="chapter-item "><a href="../lang/builtins/time.html"> Time</a></li><li class="chapter-item "><a href="../lang/builtins/timerange.html"> TimeRange</a></li><li class="chapter-item "><a href="../lang/builtins/tx.html"> Tx</a></li><li class="chapter-item "><a href="../lang/builtins/txid.html"> TxId</a></li><li class="chapter-item "><a href="../lang/builtins/txinput.html"> TxInput</a></li><li class="chapter-item "><a href="../lang/builtins/txoutput.html"> TxOutput</a></li><li class="chapter-item "><a href="../lang/builtins/txoutputid.html"> TxOutputId</a></li><li class="chapter-item "><a href="../lang/builtins/validatorhash.html"> ValidatorHash</a></li><li class="chapter-item "><a href="../lang/builtins/valuable.html"> Valuable</a></li><li class="chapter-item "><a href="../lang/builtins/value.html"> Value</a></li></ol></li></ol></li><li class="chapter-item "><a href="../api/index.html"><strong aria-hidden="true">2.</strong> Helios API</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/setup.html"><strong aria-hidden="true">2.1.</strong> Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/deno.html"> Deno</a></li></ol></li><li class="chapter-item "><a href="../api/compiling.html"><strong aria-hidden="true">2.2.</strong> Compiling Helios sources</a></li><li class="chapter-item "><a href="../api/generating.html"><strong aria-hidden="true">2.3.</strong> Generating datums and redeemers</a></li><li class="chapter-item "><a href="../api/building/index.html"><strong aria-hidden="true">2.4.</strong> Building transactions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/building/inputs.html"> Transaction inputs</a></li><li class="chapter-item "><a href="../api/building/outputs.html"> Transaction outputs</a></li><li class="chapter-item "><a href="../api/building/collateral.html"> Collateral</a></li><li class="chapter-item "><a href="../api/building/signers.html"> Explicit signers</a></li><li class="chapter-item "><a href="../api/building/minting.html"> Minting</a></li><li class="chapter-item "><a href="../api/building/finalizing.html"> Finalizing</a></li><li class="chapter-item "><a href="../api/building/signing-and-submitting.html"> Signing and submitting</a></li></ol></li><li class="chapter-item "><a href="../api/picoswap/index.html"><strong aria-hidden="true">2.5.</strong> Example: PicoSwap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/picoswap/script.html"> Main script</a></li><li class="chapter-item "><a href="../api/picoswap/datums.html"> Generating datums</a></li><li class="chapter-item "><a href="../api/picoswap/contract-class.html"> Contract helper class</a></li><li class="chapter-item "><a href="../api/picoswap/new-sale.html"> Creating a new sale</a></li><li class="chapter-item "><a href="../api/picoswap/cancel-sale.html"> Canceling a sale</a></li><li class="chapter-item "><a href="../api/picoswap/buying.html"> Buying for-sale assets</a></li></ol></li><li class="chapter-item "><a href="../api/reference/index.html"><strong aria-hidden="true">2.6.</strong> API Reference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/reference/classes/index.html"> Classes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/reference/classes/Address.html"> Address</a></li><li class="chapter-item "><a href="../api/reference/classes/AssetClass.html"> AssetClass</a></li><li class="chapter-item "><a href="../api/reference/classes/Assets.html"> Assets</a></li><li class="chapter-item "><a href="../api/reference/classes/Bip32PrivateKey.html"> Bip32PrivateKey</a></li><li class="chapter-item "><a href="../api/reference/classes/BlockfrostV0.html"> BlockfrostV0</a></li><li class="chapter-item "><a href="../api/reference/classes/ByteArray.html"> ByteArray</a></li><li class="chapter-item "><a href="../api/reference/classes/ByteArrayData.html"> ByteArrayData</a></li><li class="chapter-item "><a href="../api/reference/classes/CborData.html"> CborData</a></li><li class="chapter-item "><a href="../api/reference/classes/Cip30Wallet.html"> Cip30Wallet</a></li><li class="chapter-item "><a href="../api/reference/classes/ConstrData.html"> ConstrData</a></li><li class="chapter-item "><a href="../api/reference/classes/Datum.html"> Datum</a></li><li class="chapter-item "><a href="../api/reference/classes/DatumHash.html"> DatumHash</a></li><li class="chapter-item "><a href="../api/reference/classes/Ed25519PrivateKey.html"> Ed25519PrivateKey</a></li><li class="chapter-item "><a href="../api/reference/classes/FuzzyTest.html"> FuzzyTest</a></li><li class="chapter-item "><a href="../api/reference/classes/HInt.html"> HInt</a></li><li class="chapter-item "><a href="../api/reference/classes/Hash.html"> Hash</a></li><li class="chapter-item "><a href="../api/reference/classes/HashedDatum.html"> HashedDatum</a></li><li class="chapter-item "><a href="../api/reference/classes/HeliosData.html"> HeliosData</a></li><li class="chapter-item "><a href="../api/reference/classes/IntData.html"> IntData</a></li><li class="chapter-item "><a href="../api/reference/classes/ListData.html"> ListData</a></li><li class="chapter-item "><a href="../api/reference/classes/MapData.html"> MapData</a></li><li class="chapter-item "><a href="../api/reference/classes/MintingPolicyHash.html"> MintingPolicyHash</a></li><li class="chapter-item "><a href="../api/reference/classes/MintingRedeemer.html"> MintingRedeemer</a></li><li class="chapter-item "><a href="../api/reference/classes/NativeScript.html"> NativeScript</a></li><li class="chapter-item "><a href="../api/reference/classes/NetworkEmulator.html"> NetworkEmulator</a></li><li class="chapter-item "><a href="../api/reference/classes/NetworkParams.html"> NetworkParams</a></li><li class="chapter-item "><a href="../api/reference/classes/NetworkSlice.html"> NetworkSlice</a></li><li class="chapter-item "><a href="../api/reference/classes/Program.html"> Program</a></li><li class="chapter-item "><a href="../api/reference/classes/PubKey.html"> PubKey</a></li><li class="chapter-item "><a href="../api/reference/classes/PubKeyHash.html"> PubKeyHash</a></li><li class="chapter-item "><a href="../api/reference/classes/Redeemer.html"> Redeemer</a></li><li class="chapter-item "><a href="../api/reference/classes/RemoteWallet.html"> RemoteWallet</a></li><li class="chapter-item "><a href="../api/reference/classes/RootPrivateKey.html"> RootPrivateKey</a></li><li class="chapter-item "><a href="../api/reference/classes/RuntimeError.html"> RuntimeError</a></li><li class="chapter-item "><a href="../api/reference/classes/ScriptHash.html"> ScriptHash</a></li><li class="chapter-item "><a href="../api/reference/classes/Signature.html"> Signature</a></li><li class="chapter-item "><a href="../api/reference/classes/Site.html"> Site</a></li><li class="chapter-item "><a href="../api/reference/classes/Source.html"> Source</a></li><li class="chapter-item "><a href="../api/reference/classes/SpendingRedeemer.html"> SpendingRedeemer</a></li><li class="chapter-item "><a href="../api/reference/classes/StakeAddress.html"> StakeAddress</a></li><li class="chapter-item "><a href="../api/reference/classes/StakeKeyHash.html"> StakeKeyHash</a></li><li class="chapter-item "><a href="../api/reference/classes/StakingValidatorHash.html"> StakingValidatorHash</a></li><li class="chapter-item "><a href="../api/reference/classes/Tx.html"> Tx</a></li><li class="chapter-item "><a href="../api/reference/classes/TxBody.html"> TxBody</a></li><li class="chapter-item "><a href="../api/reference/classes/TxChain.html"> TxChain</a></li><li class="chapter-item "><a href="../api/reference/classes/TxId.html"> TxId</a></li><li class="chapter-item "><a href="../api/reference/classes/TxInput.html"> TxInput</a></li><li class="chapter-item "><a href="../api/reference/classes/TxOutput.html"> TxOutput</a></li><li class="chapter-item "><a href="../api/reference/classes/TxOutputId.html"> TxOutputId</a></li><li class="chapter-item "><a href="../api/reference/classes/TxRefInput.html"> TxRefInput</a></li><li class="chapter-item "><a href="../api/reference/classes/TxWitnesses.html"> TxWitnesses</a></li><li class="chapter-item "><a href="../api/reference/classes/UTxO.html"> UTxO</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcBool.html"> UplcBool</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcBuiltin.html"> UplcBuiltin</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcByteArray.html"> UplcByteArray</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcCall.html"> UplcCall</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcConst.html"> UplcConst</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcData.html"> UplcData</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcDataValue.html"> UplcDataValue</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcDelay.html"> UplcDelay</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcError.html"> UplcError</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcForce.html"> UplcForce</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcInt.html"> UplcInt</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcLambda.html"> UplcLambda</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcList.html"> UplcList</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcPair.html"> UplcPair</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcProgram.html"> UplcProgram</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcString.html"> UplcString</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcTerm.html"> UplcTerm</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcType.html"> UplcType</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcUnit.html"> UplcUnit</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcValue.html"> UplcValue</a></li><li class="chapter-item "><a href="../api/reference/classes/UplcVariable.html"> UplcVariable</a></li><li class="chapter-item "><a href="../api/reference/classes/UserError.html"> UserError</a></li><li class="chapter-item "><a href="../api/reference/classes/ValidatorHash.html"> ValidatorHash</a></li><li class="chapter-item "><a href="../api/reference/classes/Value.html"> Value</a></li><li class="chapter-item "><a href="../api/reference/classes/WalletEmulator.html"> WalletEmulator</a></li><li class="chapter-item "><a href="../api/reference/classes/WalletHelper.html"> WalletHelper</a></li></ol></li><li class="chapter-item "><a href="../api/reference/functions.html"> Functions</a></li><li class="chapter-item "><a href="../api/reference/interfaces/index.html"> Interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/reference/interfaces/Network.html"> Network</a></li><li class="chapter-item "><a href="../api/reference/interfaces/PrivateKey.html"> PrivateKey</a></li><li class="chapter-item "><a href="../api/reference/interfaces/Wallet.html"> Wallet</a></li></ol></li><li class="chapter-item "><a href="../api/reference/namespaces/index.html"> Namespaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../api/reference/namespaces/Cbor.html"> Cbor</a></li><li class="chapter-item "><a href="../api/reference/namespaces/CoinSelection.html"> CoinSelection</a></li><li class="chapter-item "><a href="../api/reference/namespaces/Crypto.html"> Crypto</a></li><li class="chapter-item "><a href="../api/reference/namespaces/Ed25519.html"> Ed25519</a></li><li class="chapter-item "><a href="../api/reference/namespaces/config.html"> config</a></li></ol></li><li class="chapter-item "><a href="../api/reference/types.html"> Types</a></li><li class="chapter-item "><a href="../api/reference/variables.html"> Variables</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../cli/index.html"><strong aria-hidden="true">3.</strong> Helios CLI</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../cli/setup.html"><strong aria-hidden="true">3.1.</strong> Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../cli/install.html"> Install helios-cli</a></li><li class="chapter-item "><a href="../cli/cardano-node.html"> Setup cardano-node</a></li><li class="chapter-item "><a href="../cli/wallet.html"> Wallet setup</a></li></ol></li><li class="chapter-item "><a href="../cli/usage.html"><strong aria-hidden="true">3.2.</strong> Using helios-cli</a></li><li class="chapter-item "><a href="../cli/example-always-succeeds.html"><strong aria-hidden="true">3.3.</strong> Example: Always succeeds</a></li><li class="chapter-item expanded "><a href="../cli/example-time-lock.html" class="active"><strong aria-hidden="true">3.4.</strong> Example: Time lock</a></li></ol></li><li class="chapter-item "><a href="../integrations/index.html"><strong aria-hidden="true">4.</strong> Integrations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../integrations/different-versions.html"><strong aria-hidden="true">4.1.</strong> Different versions of Helios</a></li><li class="chapter-item "><a href="../integrations/vscode.html"><strong aria-hidden="true">4.2.</strong> VSCode</a></li><li class="chapter-item "><a href="../integrations/webpack.html"><strong aria-hidden="true">4.3.</strong> Webpack</a></li></ol></li><li class="chapter-item "><a href="../advanced-concepts/index.html"><strong aria-hidden="true">5.</strong> Advanced concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../advanced-concepts/exploits.html"><strong aria-hidden="true">5.1.</strong> Exploits</a></li><li class="chapter-item "><a href="../advanced-concepts/ir/index.html"><strong aria-hidden="true">5.2.</strong> Intermediate representation</a></li><li class="chapter-item "><a href="../advanced-concepts/ir/simplification.html"><strong aria-hidden="true">5.3.</strong> Simplification</a></li><li class="chapter-item "><a href="../advanced-concepts/minting/index.html"><strong aria-hidden="true">5.4.</strong> Minting native assets</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../advanced-concepts/minting/signature.html"> Signature based minting</a></li><li class="chapter-item "><a href="../advanced-concepts/minting/unique.html"> Unique minting</a></li></ol></li><li class="chapter-item "><a href="../advanced-concepts/vesting-contract.html"><strong aria-hidden="true">5.5.</strong> Vesting contract</a></li><li class="chapter-item "><a href="../advanced-concepts/english-auction.html"><strong aria-hidden="true">5.6.</strong> English auction</a></li><li class="chapter-item "><a href="../advanced-concepts/oracle-pools.html"><strong aria-hidden="true">5.7.</strong> Oracle pools</a></li><li class="chapter-item "><a href="../advanced-concepts/dapps.html"><strong aria-hidden="true">5.8.</strong> dApp recommendations</a></li><li class="chapter-item "><a href="../advanced-concepts/tx-finalization.html"><strong aria-hidden="true">5.9.</strong> Tx finalization</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Helios Smart Contract Language</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/hyperion-bt/helios-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><a href="../cli/index.html">Helios CLI</a>/</p>
<h1 id="example-time-lock"><a class="header" href="#example-time-lock">Example: Time lock</a></h1>
<p>The <em>always-succeeds</em> contract in the <a href="./example-always-succeeds.html">previous section</a> isn't very useful. Something that is still simple, but has real-world applications, is a <em>time-lock</em> contract. Actors send UTxOs to the <em>time-lock</em> address with a datum that contains a <em>lock-until</em> time. An optional nonce can be included in the datum to allow only the actors who know the nonce value to retrieve the UTxOs. The wallet from which the original UTxOs were sent is also able to retrieve the UTxOs at any time.</p>
<p>The Helios script:</p>
<pre><code class="language-helios">spending time_lock

struct Datum {
    lockUntil: Time
    owner:     PubKeyHash // can't get this info from the ScriptContext
    nonce:     Int
}

func main(datum: Datum, _, ctx: ScriptContext) -&gt; Bool {
    tx: Tx = ctx.tx;
    now: Time = tx.time_range.start;
    returnToOwner: Bool = tx.is_signed_by(datum.owner);

    (now &gt; datum.lockUntil) || returnToOwner
}
// end-of-main, anything that comes after isn't part of the on-chain script

// MY_DATUM parameters
const LOCK_UNTIL = 0 // seconds since 1970, set by cli
const OWNER = PubKeyHash::new(#) // set by cli
const NONCE = 42 // can be set by cli

// Helios can evaluate MY_DATUM into a data-structure that can be used to build a transaction
const MY_DATUM = Datum{
  lockUntil: Time::new(LOCK_UNTIL*1000),  // needs to be in milliseconds
  owner:     OWNER, 
  nonce:     NONCE
}
</code></pre>
<p>UTxOs can be sent into the time-lock script arbitrarily as long as the datum has the correct format. UTxOs can be retrieved any time by the wallet that initiated the time-lock. UTxOs can be retrieved after the time-lock by anyone who knows the datum.</p>
<p>Once we have written the script, we generate its JSON representation using <em>helios-cli</em>, and then calculate the script address using cardano-cli:</p>
<pre><code>$ helios compile time_lock.hl

{&quot;type&quot;: &quot;PlutusScriptV2&quot;, &quot;description&quot;: &quot;&quot;, &quot;cborHex&quot;: &quot;5...&quot;}
</code></pre>
<pre><code>$ docker exec -it &lt;container-id&gt; bash

&gt; echo '{
  &quot;type&quot;: &quot;PlutusScriptV1&quot;,
  &quot;description&quot;: &quot;&quot;,
  &quot;cborHex&quot;: &quot;5...&quot;,
}' &gt; /data/scripts/time-lock.json

&gt; cardano-cli address build \
  --payment-script-file /data/scripts/time-lock.json \
  --out-file /data/scripts/time-lock.addr \
  --testnet-magic $TESTNET_MAGIC_NUM

&gt; cat time-lock.addr

addr_test1...
</code></pre>
<p>For the datum we need the <code>PubKeyHash</code> of the initiating wallet (i.e. the owner):</p>
<pre><code>$ docker exec -it &lt;container-id&gt; bash

&gt; cardano-cli address key-hash --payment-verification-key-file /data/wallets/wallet1.vkey

1d22b9ff5fc...
</code></pre>
<p>We also need a <code>lockUntil</code> time, for example 5 minutes from now. Now we can build the datum:</p>
<pre><code>$ helios eval time_lock.hl MY_DATUM \
  -DOWNER &quot;000102030405060708090a0b0c0d0e0f101112131415161718191a1b&quot; \
  -DLOCK_UNTIL $(($(date +%s) + 300)) \
  -DNONCE 12345

{&quot;constructor&quot;: 0, &quot;fields&quot;: [{&quot;int&quot;: 16....}, {&quot;bytes&quot;: &quot;0001020304...&quot;}, {&quot;int&quot;: 12345}]}
</code></pre>
<p>Now let's send 2 tAda to the script address using the datum we just generated:</p>
<pre><code>$ docker exec -it &lt;container-id&gt; bash

&gt; cardano-cli query utxo \
  --address $(cat /data/wallets/wallet1.addr) \
  --testnet-magic $TESTNET_MAGIC_NUM

...
# take note of a UTxO big enough to cover 2 tAda + fees

&gt; DATUM=$(mktemp)
&gt; echo '{&quot;constructor&quot;: 0, &quot;fields&quot;: [{&quot;int&quot;: 16....}, {&quot;int&quot;: 42}]}' &gt; $DATUM

&gt; DATUM_HASH=$(cardano-cli transaction hash-script-data --script-data-file $DATUM)

&gt; TX_BODY=$(mktemp)
&gt; cardano-cli transaction build \
  --tx-in &lt;funding-utxo&gt; \
  --tx-out $(cat /data/scripts/time-lock.addr)+2000000 \
  --tx-out-datum-hash $DATUM_HASH \
  --change-address $(cat /data/wallets/wallet1.addr) \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --out-file $TX_BODY \
  --babbage-era

Estimated transaction fee: Lovelace 167217

&gt; TX_SIGNED=$(mktemp)
&gt; cardano-cli transaction sign \
  --tx-body-file $TX_BODY \
  --signing-key-file /data/wallets/wallet1.skey \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --out-file $TX_SIGNED

&gt; cardano-cli transaction submit \
  --tx-file $TX_SIGNED \
  --testnet-magic $TESTNET_MAGIC_NUM

Transaction successfully submitted
</code></pre>
<p>Wait for the transaction to propagate through the network, and query the script address to see the locked UTxO(s).</p>
<p>First thing we should test is returning the UTxO(s) back to wallet 1. For that we use the following transaction:</p>
<pre><code>&gt; PARAMS=$(mktemp) # most recent protocol params
&gt; cardano-cli query protocol-parameters --testnet-magic $TESTNET_MAGIC_NUM &gt; $PARAMS

&gt; TX_BODY=$(mktemp)
&gt; cardano-cli transaction build \
  --tx-in &lt;fee-utxo&gt; \ # used for tx fee
  --tx-in &lt;script-utxo \
  --tx-in-datum-file $DATUM \
  --tx-in-redeemer-value &lt;arbitrary-redeemer-data&gt; \
  --tx-in-script-file /data/scripts/time-lock.json \
  --tx-in-collateral &lt;fee-utxo&gt; \ # used for script collateral
  --invalid-before &lt;current-slot-no&gt; \
  --required-signer /data/wallets/wallet1.skey \
  --change-address $(cat /data/wallets/wallet1.addr) \
  --tx-out $(cat /data/wallets/wallet1.addr)+2000000 \
  --out-file $TX_BODY \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --protocol-params-file $PARAMS \
  --babbage-era

Estimated transaction fee: Lovelace ...

&gt; TX_SIGNED=$(mktemp)
&gt; cardano-cli transaction sign \
  --tx-body-file $TX_BODY \
  --signing-key-file /data/wallets/wallet1.skey \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --out-file $TX_SIGNED

&gt; cardano-cli transaction submit \
  --tx-file $TX_SIGNED \
  --testnet-magic $TESTNET_MAGIC_NUM

Transaction successfully submitted
</code></pre>
<p>Note that this transaction <em>build</em> command differs slightly from the <em>Always succeeds</em> script:</p>
<ul>
<li><code>--invalid-before &lt;current-slot-no&gt;</code> is needed so the transaction is aware of the current time (via the start of the valid time-range). It might seem weird to specify (an approximation of) the current time at this point, as someone might try to cheat the time-lock by specifying a time far into the future. But the slot-leader checks the time-range as well, and rejects any transaction whose time-range doesn't contain the current slot.</li>
<li><code>--required-signer &lt;wallet-private-key-file&gt;</code> is needed so that <code>getTxSignatories(tx)</code> doesn't return an empty list.</li>
</ul>
<p>The second thing we must test is claiming the time-locked funds from another wallet (eg. wallet 2). Let's assume that the time-lock script still contains the 2 tAda sent by wallet 1, and that sufficient time has passed. Wallet 2 can claim the UTxO(s) using the following commands:</p>
<pre><code>&gt; PARAMS=$(mktemp) # most recent protocol params
&gt; cardano-cli query protocol-parameters --testnet-magic $TESTNET_MAGIC_NUM &gt; $PARAMS

&gt; TX_BODY=$(mktemp)
&gt; cardano-cli transaction build \
  --tx-in &lt;fee-utxo&gt; \ # used for tx fee
  --tx-in &lt;script-utxo&gt; \
  --tx-in-datum-file $DATUM \
  --tx-in-redeemer-value &lt;arbitrary-redeemer-data&gt; \
  --tx-in-script-file /data/scripts/time-lock.json \
  --tx-in-collateral &lt;fee-utxo&gt; \ # used for script collateral
  --invalid-before &lt;current-slot-no&gt; \
  --change-address $(cat /data/wallets/wallet2.addr) \
  --tx-out $(cat /data/wallets/wallet2.addr)+2000000 \
  --out-file $TX_BODY \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --protocol-params-file $PARAMS \
  --babbage-era

Estimated transaction fee: Lovelace ...

&gt; TX_SIGNED=$(mktemp)
&gt; cardano-cli transaction sign \
  --tx-body-file $TX_BODY \
  --signing-key-file /data/wallets/wallet2.skey \
  --testnet-magic $TESTNET_MAGIC_NUM \
  --out-file $TX_SIGNED

&gt; cardano-cli transaction submit \
  --tx-file $TX_SIGNED \
  --testnet-magic $TESTNET_MAGIC_NUM

Transaction successfully submitted
</code></pre>
<p>cardano-cli should give an error if you try to submit this transaction before the <code>lockUntil</code> time. After that time it should succeed, and wallet 2 will receive the time-locked UTxO(s).</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../cli/example-always-succeeds.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../integrations/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../cli/example-always-succeeds.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../integrations/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../src/custom.js"></script>


    </div>
    </body>
</html>
